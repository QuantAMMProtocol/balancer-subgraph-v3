# Adding Support for New Networks

To add support for a new network in the Balancer v3 subgraphs, follow these steps:

## 1. Update networks.json

Add the new network configuration to the `networks.json` file in the root of the repository.

Example:

```json
{
  "network-name": {
    "Vault": {
      "address": "0x...",
      "startBlock": 0
    },
    "ProtocolFeeController": {
      "address": "0x...",
      "startBlock": 0
    },
    "WeightedPoolFactory": {
      "address": "0x...",
      "startBlock": 0
    },
    "StablePoolFactory": {
      "address": "0x...",
      "startBlock": 0
    }
  }
}
```

Replace `"network-name"` with the CLI name found in TheGraph docs, and fill in the correct contract addresses and starting block numbers for the new network.

For more information on supported networks and their naming conventions, refer to [The Graph's documentation](https://thegraph.com/docs/en/developing/supported-networks/).

## 2. Update GitHub Actions Workflows

Add new deployment jobs in both workflow files for the new network:

For `deploy-v3-pools.yml`, add:

```yaml
  deploy-network-name:
    uses: ./.github/workflows/deploy-subgraph.yml
    with:
      working-directory: subgraphs/v3-pools
      subgraph-name: balancer-pools-v3-network-name
      manifest-file: subgraph.network-name.yaml
    secrets:
      GRAPH_DEPLOY_KEY: ${{ secrets.GRAPH_DEPLOY_KEY }}
```

For `deploy-v3-vault.yml`, add:

```yaml
  deploy-network-name:
    uses: ./.github/workflows/deploy-subgraph.yml
    with:
      working-directory: subgraphs/v3-vault
      subgraph-name: balancer-v3-network-name
      manifest-file: subgraph.network-name.yaml
    secrets:
      GRAPH_DEPLOY_KEY: ${{ secrets.GRAPH_DEPLOY_KEY }}
```

Make sure to:

1. Replace all instances of `network-name` with your actual network name
2. Update the subgraph name in the deploy commands to match your network
3. Ensure the manifest file names match what will be generated by your manifest generation script

## 3. Generate Configs and Deploy

After updating `networks.json` and the GitHub Actions files:

1. Run `pnpm generate-manifests`
2. Verify the manifests and commit all changes
3. Open a PR - subgraphs will deploy automatically when merged
